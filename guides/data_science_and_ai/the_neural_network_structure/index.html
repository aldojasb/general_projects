
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aldojasb.github.io/general_projects/guides/data_science_and_ai/the_neural_network_structure/">
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../reinforcement_learning_basics/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>The Neural Network Structure - Aldo Saltao's Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-neural-network" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Aldo Saltao&#39;s Portfolio" class="md-header__button md-logo" aria-label="Aldo Saltao's Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Aldo Saltao's Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Neural Network Structure
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../work_with_me/overview/" class="md-tabs__link">
          
  
  Work With Me

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../software_architecture/overview/" class="md-tabs__link">
          
  
  Software Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ai_product_development/overview/" class="md-tabs__link">
          
  
  AI Product Management

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  Data Science & AI

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development_and_devops/overview/" class="md-tabs__link">
          
  
  Development & MLOps

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../demos/overview/" class="md-tabs__link">
          
  
  Demos

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Aldo Saltao&#39;s Portfolio" class="md-nav__button md-logo" aria-label="Aldo Saltao's Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    Aldo Saltao's Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Work With Me
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Work With Me
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work_with_me/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work_with_me/ai_systems_that_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Systems That Work
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work_with_me/ai_foundations_and_capability_building/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Foundations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Software Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_architecture/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_architecture/SOLID_principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SOLID Principles
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AI Product Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            AI Product Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_product_development/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_product_development/framework_that_embraces_uncertainty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Framework That Embraces Uncertainty
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_product_development/the_moscow_method/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The MoSCoW Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai_product_development/skateboard_mindset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Skateboard Mindset
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data Science & AI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Data Science & AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    The Neural Network Structure
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    The Neural Network Structure
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-the-neural-network-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: The Neural Network Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neuras-painting-studio" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura’s Painting Studio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-the-network-look-like" class="md-nav__link">
    <span class="md-ellipsis">
      What Does the Network Look Like?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-input-neura-paints-for-two-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Example Input: Neura Paints for Two Sketches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-modelinputs-works-internally" class="md-nav__link">
    <span class="md-ellipsis">
      How model(inputs) Works Internally
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How model(inputs) Works Internally">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy-neuras-painting-process" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura’s Painting Process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activation-function-why-relu" class="md-nav__link">
    <span class="md-ellipsis">
      Activation Function: Why ReLU?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Activation Function: Why ReLU?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy-relu-as-neuras-creative-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: ReLU as Neura’s "Creative Filter"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-math" class="md-nav__link">
    <span class="md-ellipsis">
      In math:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-is-it-important" class="md-nav__link">
    <span class="md-ellipsis">
      Why is it important?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heads-up-the-vanishing-gradient-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Heads-Up: The Vanishing Gradient Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Heads-Up: The Vanishing Gradient Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relu-fixes-that" class="md-nav__link">
    <span class="md-ellipsis">
      ReLU Fixes That
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visual-flow-of-data" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Flow of Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-table" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-input-and-prediction-the-forward-pass" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Input and Prediction (The Forward Pass)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neura-receives-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura Receives Sketches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-example-batch-of-2-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example (Batch of 2 sketches)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-actually-happens-under-the-hood" class="md-nav__link">
    <span class="md-ellipsis">
      What Actually Happens (Under the Hood)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Actually Happens (Under the Hood)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-loss-function-how-bad-was-the-painting" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Loss Function – How Bad Was the Painting?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neura-gets-judged" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura Gets Judged
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      The Loss Function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Loss Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-mse-doing" class="md-nav__link">
    <span class="md-ellipsis">
      What is MSE doing?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analogy-continued" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy (continued)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps-2-and-3" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Steps 2 and 3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-backpropagation-compute-the-feedback" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Backpropagation – Compute the Feedback
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-backpropagation" class="md-nav__link">
    <span class="md-ellipsis">
      What Is Backpropagation?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neura-analogy-backprop-as-a-feedback-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Neura Analogy: Backprop as a Feedback Chain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-happens-in-lossbackward" class="md-nav__link">
    <span class="md-ellipsis">
      What Happens in loss.backward()?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Happens in loss.backward()?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-insight" class="md-nav__link">
    <span class="md-ellipsis">
      Code Insight
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neuras-intuition" class="md-nav__link">
    <span class="md-ellipsis">
      Neura’s Intuition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-the-chain-rule-guides-neura" class="md-nav__link">
    <span class="md-ellipsis">
      How the Chain Rule Guides Neura
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How the Chain Rule Guides Neura">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#real-math-example-1-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Real Math Example (1-layer)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-optimizer-apply-the-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Optimizer – Apply the Corrections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Optimizer – Apply the Corrections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-sgd-formula" class="md-nav__link">
    <span class="md-ellipsis">
      The SGD Formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neura-analogy-different-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      Neura Analogy: Different Optimizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Neura Analogy: Different Optimizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sgd-stochastic-gradient-descent" class="md-nav__link">
    <span class="md-ellipsis">
      SGD (Stochastic Gradient Descent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adam-adaptive-moment-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Adam (Adaptive Moment Estimation)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-table" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-the-feedback-fix-loop" class="md-nav__link">
    <span class="md-ellipsis">
      Summary: The Feedback &amp; Fix Loop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-training-loop-repetition-makes-perfect" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Training Loop – Repetition Makes Perfect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-practice-makes-the-painter" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Practice Makes the Painter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-happens-in-each-epoch" class="md-nav__link">
    <span class="md-ellipsis">
      What Happens in Each Epoch?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-logging-training-info-in-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      Code – Logging Training Info in Pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-interpret-the-table" class="md-nav__link">
    <span class="md-ellipsis">
      How to Interpret the Table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to Interpret the Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-to-look-for" class="md-nav__link">
    <span class="md-ellipsis">
      What to Look For:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reinforcement_learning_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handson_rl_application_ppo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on RL application (PPO) for Chemical Process Control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ds_products_as_python_packages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Science Products as Python Packages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clustering_algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k-means_visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering Algorithms Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development & MLOps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Development & MLOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/introduction_to_dev_container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to Dev-Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/logging_manager_package/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loggin Manager Package
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/tdd_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test-Driven Development (TDD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/versioning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning package on GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_devops/mkdocs_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation with mkdocs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Demos
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Demos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demos/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-the-neural-network-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: The Neural Network Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neuras-painting-studio" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura’s Painting Studio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-the-network-look-like" class="md-nav__link">
    <span class="md-ellipsis">
      What Does the Network Look Like?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-input-neura-paints-for-two-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Example Input: Neura Paints for Two Sketches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-modelinputs-works-internally" class="md-nav__link">
    <span class="md-ellipsis">
      How model(inputs) Works Internally
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How model(inputs) Works Internally">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy-neuras-painting-process" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura’s Painting Process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activation-function-why-relu" class="md-nav__link">
    <span class="md-ellipsis">
      Activation Function: Why ReLU?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Activation Function: Why ReLU?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy-relu-as-neuras-creative-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: ReLU as Neura’s "Creative Filter"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-math" class="md-nav__link">
    <span class="md-ellipsis">
      In math:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-is-it-important" class="md-nav__link">
    <span class="md-ellipsis">
      Why is it important?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heads-up-the-vanishing-gradient-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Heads-Up: The Vanishing Gradient Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Heads-Up: The Vanishing Gradient Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relu-fixes-that" class="md-nav__link">
    <span class="md-ellipsis">
      ReLU Fixes That
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visual-flow-of-data" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Flow of Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-table" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-input-and-prediction-the-forward-pass" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Input and Prediction (The Forward Pass)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neura-receives-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura Receives Sketches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-example-batch-of-2-sketches" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example (Batch of 2 sketches)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-actually-happens-under-the-hood" class="md-nav__link">
    <span class="md-ellipsis">
      What Actually Happens (Under the Hood)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Actually Happens (Under the Hood)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analogy" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-loss-function-how-bad-was-the-painting" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Loss Function – How Bad Was the Painting?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-neura-gets-judged" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Neura Gets Judged
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      The Loss Function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Loss Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-mse-doing" class="md-nav__link">
    <span class="md-ellipsis">
      What is MSE doing?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analogy-continued" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy (continued)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps-2-and-3" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Steps 2 and 3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-backpropagation-compute-the-feedback" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Backpropagation – Compute the Feedback
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-backpropagation" class="md-nav__link">
    <span class="md-ellipsis">
      What Is Backpropagation?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neura-analogy-backprop-as-a-feedback-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Neura Analogy: Backprop as a Feedback Chain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-happens-in-lossbackward" class="md-nav__link">
    <span class="md-ellipsis">
      What Happens in loss.backward()?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Happens in loss.backward()?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-insight" class="md-nav__link">
    <span class="md-ellipsis">
      Code Insight
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neuras-intuition" class="md-nav__link">
    <span class="md-ellipsis">
      Neura’s Intuition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-the-chain-rule-guides-neura" class="md-nav__link">
    <span class="md-ellipsis">
      How the Chain Rule Guides Neura
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How the Chain Rule Guides Neura">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#real-math-example-1-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Real Math Example (1-layer)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-optimizer-apply-the-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Optimizer – Apply the Corrections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Optimizer – Apply the Corrections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-sgd-formula" class="md-nav__link">
    <span class="md-ellipsis">
      The SGD Formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-example" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neura-analogy-different-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      Neura Analogy: Different Optimizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Neura Analogy: Different Optimizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sgd-stochastic-gradient-descent" class="md-nav__link">
    <span class="md-ellipsis">
      SGD (Stochastic Gradient Descent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adam-adaptive-moment-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Adam (Adaptive Moment Estimation)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-table" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-the-feedback-fix-loop" class="md-nav__link">
    <span class="md-ellipsis">
      Summary: The Feedback &amp; Fix Loop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-training-loop-repetition-makes-perfect" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Training Loop – Repetition Makes Perfect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analogy-practice-makes-the-painter" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy: Practice Makes the Painter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-happens-in-each-epoch" class="md-nav__link">
    <span class="md-ellipsis">
      What Happens in Each Epoch?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-logging-training-info-in-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      Code – Logging Training Info in Pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-interpret-the-table" class="md-nav__link">
    <span class="md-ellipsis">
      How to Interpret the Table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to Interpret the Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-to-look-for" class="md-nav__link">
    <span class="md-ellipsis">
      What to Look For:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="the-neural-network">The Neural Network<a class="headerlink" href="#the-neural-network" title="Permanent link">&para;</a></h1>
<h2 id="step-1-the-neural-network-structure">Step 1: The Neural Network Structure<a class="headerlink" href="#step-1-the-neural-network-structure" title="Permanent link">&para;</a></h2>
<h2 id="analogy-neuras-painting-studio">Analogy: Neura’s Painting Studio<a class="headerlink" href="#analogy-neuras-painting-studio" title="Permanent link">&para;</a></h2>
<p>Imagine you’re training a robot artist named <strong>Neura</strong>. She creates paintings based on three key inputs:</p>
<ul>
<li><strong>Color mix ratio</strong></li>
<li><strong>Brush pressure</strong></li>
<li><strong>Tilt angle</strong></li>
</ul>
<p>Each painting starts from a <strong>sketch</strong> made of these 3 values.</p>
<p>But Neura doesn’t just throw those values directly onto the canvas — she sends them through <strong>a sequence of creative stations (layers)</strong>, where she processes, transforms, and combines the inputs using <strong>adjustable brushes</strong> (weights and biases) and <strong>creative filters</strong> (activation functions).</p>
<p><img alt="Neura’s Painting Studio" src="../../images/neura_image.png" /></p>
<hr />
<h2 id="what-does-the-network-look-like">What Does the Network Look Like?<a class="headerlink" href="#what-does-the-network-look-like" title="Permanent link">&para;</a></h2>
<p>We’re using:</p>
<ul>
<li><strong>3 inputs</strong> (color, pressure, tilt)</li>
<li><strong>1 hidden layer with 4 neurons</strong></li>
<li><strong>1 output</strong> (a score or prediction)</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NeuralPainter</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 3 inputs → 4 hidden neurons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 4 → 1 output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># Neura applies her creative filter</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralPainter</span><span class="p">()</span>
</code></pre></div>
<img alt="Neura’s Painting Studio" src="../../images/neutal_networking_example_1.png" /></p>
<hr />
<h2 id="example-input-neura-paints-for-two-sketches">Example Input: Neura Paints for Two Sketches<a class="headerlink" href="#example-input-neura-paints-for-two-sketches" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>  <span class="c1"># Sketch 1: a gentle stroke with a warm tone</span>
    <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>   <span class="c1"># Sketch 2: a bold stroke with a tilted brush</span>
<span class="p">])</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>
<p>The input shape is <code>[2, 3]</code>:</p>
<ul>
<li>2 samples (batch size)</li>
<li>3 features each (color, pressure, tilt)</li>
</ul>
<p>Neura paints <strong>both sketches at once</strong> using the same model!</p>
<hr />
<h2 id="how-modelinputs-works-internally">How <code>model(inputs)</code> Works Internally<a class="headerlink" href="#how-modelinputs-works-internally" title="Permanent link">&para;</a></h2>
<p>When you run <code>model(inputs)</code>, PyTorch is doing this under the hood:</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>  <span class="c1"># Magic from nn.Module</span>
<span class="err">→</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="c1"># This is your blueprint in action</span>
</code></pre></div>
<h3 id="analogy-neuras-painting-process">Analogy: Neura’s Painting Process<a class="headerlink" href="#analogy-neuras-painting-process" title="Permanent link">&para;</a></h3>
<p>Neura has multiple <strong>stations</strong> with different <strong>brushes</strong>. The <code>forward()</code> method is the <strong>blueprint</strong> that tells her:</p>
<blockquote>
<p>“Here’s how to go from the sketch to the final painting.”</p>
</blockquote>
<p>So in practice:</p>
<ul>
<li>She sends inputs through <code>layer1</code></li>
<li>Applies a <strong>filter</strong> (ReLU) to remove weak/unhelpful strokes</li>
<li>Passes the result to <code>layer2</code> to finalize the artwork</li>
</ul>
<hr />
<h2 id="activation-function-why-relu">Activation Function: Why ReLU?<a class="headerlink" href="#activation-function-why-relu" title="Permanent link">&para;</a></h2>
<h3 id="analogy-relu-as-neuras-creative-filter">Analogy: ReLU as Neura’s "Creative Filter"<a class="headerlink" href="#analogy-relu-as-neuras-creative-filter" title="Permanent link">&para;</a></h3>
<p>After the first station (layer), Neura stops and reflects:</p>
<blockquote>
<p>“If a stroke had a <strong>positive effect</strong>, I’ll keep it.
 If it hurt the painting (negative), I’ll just <strong>erase it</strong>.”</p>
</blockquote>
<p>That’s what ReLU (Rectified Linear Unit) does.</p>
<h3 id="in-math">In math:<a class="headerlink" href="#in-math" title="Permanent link">&para;</a></h3>
<p><div class="highlight"><pre><span></span><code><span class="n">ReLU</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Max</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>
</code></pre></div>
It turns <strong>all negative values into 0</strong> and leaves <strong>positive values unchanged</strong>.</p>
<h3 id="why-is-it-important">Why is it important?<a class="headerlink" href="#why-is-it-important" title="Permanent link">&para;</a></h3>
<p>Without ReLU (or another activation function), Neura’s network is just a <strong>giant linear equation</strong>. No matter how many layers she adds, she’s still only able to draw <strong>straight lines</strong> — no curves, corners, shadows, or depth.</p>
<p><strong>ReLU adds non-linearity</strong>, giving her the power to paint <strong>abstract shapes</strong>, <strong>fluid transitions</strong>, and <strong>creative patterns</strong>.</p>
<hr />
<h2 id="heads-up-the-vanishing-gradient-problem">Heads-Up: The Vanishing Gradient Problem<a class="headerlink" href="#heads-up-the-vanishing-gradient-problem" title="Permanent link">&para;</a></h2>
<p>In deeper networks, we train Neura by passing <strong>feedback backward</strong> through the layers — telling her how to improve.</p>
<p>With older activations like <strong>sigmoid</strong> or <strong>tanh</strong>, the feedback (gradient) gets <strong>squashed</strong> at each layer, until it’s <strong>too tiny to matter</strong>.</p>
<p>That means:</p>
<ul>
<li>Neura’s early brushes don’t get meaningful corrections</li>
<li>Those layers <strong>stop learning</strong></li>
<li>Training <strong>slows down or fails</strong></li>
</ul>
<h3 id="relu-fixes-that">ReLU Fixes That<a class="headerlink" href="#relu-fixes-that" title="Permanent link">&para;</a></h3>
<p>ReLU gradients are:</p>
<ul>
<li>1 (if the output was positive)</li>
<li>0 (if the output was zeroed)</li>
</ul>
<p>This helps gradients <strong>survive the trip back</strong> — so every brush in Neura’s chain gets useful feedback.</p>
<hr />
<h2 id="visual-flow-of-data">Visual Flow of Data<a class="headerlink" href="#visual-flow-of-data" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>[Color, Pressure, Tilt]   ← sketch features
      ↓
  [Layer 1: Linear → ReLU] ← brush stroke + filter
      ↓
  [Layer 2: Linear]        ← combine and score
      ↓
  [Final Prediction]       ← painting score for each sample
</code></pre></div>
<hr />
<h2 id="summary-table">Summary Table<a class="headerlink" href="#summary-table" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Concept</th>
<th>PyTorch</th>
<th>Neura Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Inputs</td>
<td><code>[batch_size, 3]</code></td>
<td>Sketches: color, pressure, tilt</td>
</tr>
<tr>
<td><code>__init__()</code></td>
<td>Layer definitions</td>
<td>Neura sets up painting stations</td>
</tr>
<tr>
<td><code>forward()</code></td>
<td>Flow of data</td>
<td>Neura’s blueprint for painting</td>
</tr>
<tr>
<td><code>model(inputs)</code></td>
<td>Calls <code>forward()</code></td>
<td>You hand Neura 2 sketches and ask her to paint them</td>
</tr>
<tr>
<td>Activation Function</td>
<td><code>ReLU</code></td>
<td>Neura filters out weak/negative strokes</td>
</tr>
<tr>
<td>Vanishing Gradients</td>
<td>Solved by <code>ReLU</code></td>
<td>Neura’s early brushes still get good feedback</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="step-2-input-and-prediction-the-forward-pass">Step 2: Input and Prediction (The Forward Pass)<a class="headerlink" href="#step-2-input-and-prediction-the-forward-pass" title="Permanent link">&para;</a></h2>
<h2 id="analogy-neura-receives-sketches">Analogy: Neura Receives Sketches<a class="headerlink" href="#analogy-neura-receives-sketches" title="Permanent link">&para;</a></h2>
<p>You hand Neura <strong>two sketch requests</strong>:</p>
<ol>
<li>A warm, firm stroke with a light tilt</li>
<li>A bold color, gentle pressure, and medium tilt</li>
</ol>
<p>These sketches are represented as <strong>feature vectors</strong> (3 values each).</p>
<p>Neura uses her <strong>current brush settings</strong> (weights and biases — still random at first) to attempt her first paintings.</p>
<p>She follows the <strong>forward pass blueprint</strong> defined earlier, applying her brush strokes layer by layer.</p>
<hr />
<h2 id="code-example-batch-of-2-sketches">Code Example (Batch of 2 sketches)<a class="headerlink" href="#code-example-batch-of-2-sketches" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Each row is a sketch with 3 features: [color, pressure, tilt]</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>  <span class="c1"># Sample 1</span>
    <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>   <span class="c1"># Sample 2</span>
<span class="p">])</span>

<span class="c1"># Neura tries painting using her current brush settings</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>The input shape is <code>[2, 3]</code> — 2 sketches, 3 features each.</li>
<li>The output shape is <code>[2, 1]</code> — Neura returns a <strong>prediction score</strong> for each painting.</li>
</ul>
<hr />
<h2 id="what-actually-happens-under-the-hood">What Actually Happens (Under the Hood)<a class="headerlink" href="#what-actually-happens-under-the-hood" title="Permanent link">&para;</a></h2>
<ul>
<li>Inputs go through <code>layer1</code>: Neura combines the sketch features using her hidden brushes.</li>
<li>ReLU removes unhelpful strokes (negative outputs).</li>
<li>Outputs go through <code>layer2</code>: Neura blends the remaining strokes into a final score.</li>
</ul>
<h3 id="analogy">Analogy<a class="headerlink" href="#analogy" title="Permanent link">&para;</a></h3>
<blockquote>
<p>“Neura uses her internal logic and current brushes to paint what she <em>thinks</em> each sketch should look like. It’s her best guess — for now.”</p>
</blockquote>
<p>At this point, her painting is likely far from perfect — she hasn’t received any feedback yet!</p>
<hr />
<h2 id="step-3-loss-function-how-bad-was-the-painting">Step 3: Loss Function – How Bad Was the Painting?<a class="headerlink" href="#step-3-loss-function-how-bad-was-the-painting" title="Permanent link">&para;</a></h2>
<h2 id="analogy-neura-gets-judged">Analogy: Neura Gets Judged<a class="headerlink" href="#analogy-neura-gets-judged" title="Permanent link">&para;</a></h2>
<p>After Neura finishes her two paintings, you compare each one to a reference painting and say:</p>
<blockquote>
<p>“Here's what you were <strong>actually</strong> supposed to paint.”</p>
</blockquote>
<p>This comparison generates a <strong>loss value</strong> — a number representing <strong>how far off her guesses were</strong>.</p>
<hr />
<h2 id="the-loss-function">The Loss Function<a class="headerlink" href="#the-loss-function" title="Permanent link">&para;</a></h2>
<p>We’ll use <strong>Mean Squared Error (MSE)</strong> — a common choice when outputs are continuous (like price, score, etc.).</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="c1"># Target values for each painting (the ideal outputs)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">]])</span>  <span class="c1"># Ground truth for both samples</span>

<span class="c1"># Define the loss function</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>

<span class="c1"># Calculate how far Neura was from the real painting</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</code></pre></div>
<h3 id="what-is-mse-doing">What is MSE doing?<a class="headerlink" href="#what-is-mse-doing" title="Permanent link">&para;</a></h3>
<p>It calculates:
<div class="highlight"><pre><span></span><code><span class="n">Loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Sum</span><span class="p">[(</span><span class="err">ŷᵢ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="err">ᵢ</span><span class="p">)</span><span class="err">²</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">i</span><span class="p">}]</span>
</code></pre></div>
In words:</p>
<blockquote>
<p>“For each painting, square the difference between Neura's version and the correct one, then average those errors.”</p>
</blockquote>
<hr />
<h3 id="analogy-continued">Analogy (continued)<a class="headerlink" href="#analogy-continued" title="Permanent link">&para;</a></h3>
<p>You, the mentor, hold up her two paintings next to the real ones and say:</p>
<blockquote>
<p>“Painting #1 was too light. Painting #2 missed the tone.”
 “Let’s figure out <em>how wrong</em> each one was.”</p>
</blockquote>
<p>This numeric feedback becomes <strong>the signal Neura will use to learn.</strong></p>
<p>But we’re not done yet — she still needs to figure out <strong>which brushes to adjust</strong>, and <strong>how much</strong>. That’s what happens next with backpropagation.</p>
<hr />
<h2 id="summary-of-steps-2-and-3">Summary of Steps 2 and 3<a class="headerlink" href="#summary-of-steps-2-and-3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Step</th>
<th>Code</th>
<th>Neura Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prepare Inputs</td>
<td><code>inputs = torch.tensor(...)</code></td>
<td>You hand her sketches to paint</td>
</tr>
<tr>
<td>Make Prediction</td>
<td><code>prediction = model(inputs)</code></td>
<td>Neura paints using her current skills</td>
</tr>
<tr>
<td>Define Targets</td>
<td><code>target = torch.tensor(...)</code></td>
<td>You show her what the real paintings should look like</td>
</tr>
<tr>
<td>Calculate Loss</td>
<td><code>loss = loss_fn(pred, target)</code></td>
<td>You give her a number showing how far off she was</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="step-4-backpropagation-compute-the-feedback">Step 4: Backpropagation – Compute the Feedback<a class="headerlink" href="#step-4-backpropagation-compute-the-feedback" title="Permanent link">&para;</a></h2>
<h2 id="what-is-backpropagation">What Is Backpropagation?<a class="headerlink" href="#what-is-backpropagation" title="Permanent link">&para;</a></h2>
<p>Backpropagation is the process of <strong>computing how much each weight and bias contributed to the final error</strong>, using calculus (specifically the chain rule). It’s the <strong>feedback mechanism</strong> that lets Neura improve her painting technique.</p>
<hr />
<h2 id="neura-analogy-backprop-as-a-feedback-chain">Neura Analogy: Backprop as a Feedback Chain<a class="headerlink" href="#neura-analogy-backprop-as-a-feedback-chain" title="Permanent link">&para;</a></h2>
<p>Imagine Neura just finished painting two sketches. The results were off — maybe too pale, too harsh, or missing contrast.</p>
<p>You don’t just say:</p>
<blockquote>
<p>“Do better next time.”</p>
</blockquote>
<p>Instead, you help her <strong>trace each error</strong> back to the <strong>exact brush and stroke</strong> that caused it. That’s backpropagation:</p>
<ul>
<li>“Your final stroke added too much red.”</li>
<li>“That red came from Layer 2’s pressure.”</li>
<li>“Layer 1's brush angle influenced that stroke.”</li>
</ul>
<p>Each brush station gets a <strong>personalized correction note</strong>.</p>
<hr />
<h2 id="what-happens-in-lossbackward">What Happens in <code>loss.backward()</code>?<a class="headerlink" href="#what-happens-in-lossbackward" title="Permanent link">&para;</a></h2>
<p>Once you've computed the loss:</p>
<div class="highlight"><pre><span></span><code><span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</code></pre></div>
<p>PyTorch:</p>
<ol>
<li>
<p><strong>Traverses the computation graph backward</strong></p>
</li>
<li>
<p>Uses the <strong>chain rule</strong> to compute:
   ∂Loss/∂[Each Weight/Bias]</p>
</li>
<li>
<p>Stores those gradients in each parameter’s <code>.grad</code> field</p>
</li>
</ol>
<h3 id="code-insight">Code Insight<a class="headerlink" href="#code-insight" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">grad</span>
<span class="n">model</span><span class="o">.</span><span class="n">layer2</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span>
</code></pre></div>
<p>These give the <strong>gradient values</strong> — the <strong>feedback Neura needs</strong>.</p>
<hr />
<h2 id="neuras-intuition">Neura’s Intuition<a class="headerlink" href="#neuras-intuition" title="Permanent link">&para;</a></h2>
<p>Before backprop:</p>
<blockquote>
<p>“Hmm… my painting missed the mark.”</p>
</blockquote>
<p>After backprop:</p>
<blockquote>
<p>“Ah! Brush #1 was too heavy, and brush #3 was too soft. I’ll fix those.”</p>
</blockquote>
<hr />
<h2 id="how-the-chain-rule-guides-neura">How the Chain Rule Guides Neura<a class="headerlink" href="#how-the-chain-rule-guides-neura" title="Permanent link">&para;</a></h2>
<h3 id="real-math-example-1-layer">Real Math Example (1-layer)<a class="headerlink" href="#real-math-example-1-layer" title="Permanent link">&para;</a></h3>
<p>Let’s say:</p>
<ul>
<li>Input: x = 0.5</li>
<li>Weight: w</li>
<li>Output: ŷ = w * x</li>
<li>Target: y = 1.0</li>
<li>Loss: L = (ŷ - y)²</li>
</ul>
<p>Apply chain rule:
<div class="highlight"><pre><span></span><code><span class="n">dL</span><span class="o">/</span><span class="n">dw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dL</span><span class="o">/</span><span class="n">d</span><span class="err">ŷ</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="err">ŷ</span><span class="o">/</span><span class="n">dw</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">(</span><span class="err">ŷ</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span>
</code></pre></div>
If:</p>
<ul>
<li>ŷ = 0.8</li>
<li>Error = ŷ - y = -0.2</li>
<li>x = 0.5</li>
<li>dL/dw = 2(-0.2) * 0.5 = -0.2</li>
</ul>
<p>This is the <strong>gradient</strong> — the tweak Neura needs to apply.</p>
<hr />
<h2 id="step-5-optimizer-apply-the-corrections">Step 5: Optimizer – Apply the Corrections<a class="headerlink" href="#step-5-optimizer-apply-the-corrections" title="Permanent link">&para;</a></h2>
<p>Now that Neura has her feedback (gradients), she needs to <strong>act on it</strong>.</p>
<p>This is where the <strong>optimizer</strong> comes in. It decides <strong>how much to adjust each brush</strong> (weight/bias) based on the gradient.</p>
<h3 id="the-sgd-formula">The SGD Formula<a class="headerlink" href="#the-sgd-formula" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">η</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gradient</span>
</code></pre></div>
<p>Where:</p>
<ul>
<li>η = learning rate</li>
<li>gradient = dL/dw</li>
</ul>
<h3 id="code-example">Code Example<a class="headerlink" href="#code-example" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Apply the update (after loss.backward())</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

<span class="c1"># Reset gradients before next loop</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="neura-analogy-different-optimizers">Neura Analogy: Different Optimizers<a class="headerlink" href="#neura-analogy-different-optimizers" title="Permanent link">&para;</a></h2>
<h3 id="sgd-stochastic-gradient-descent">SGD (Stochastic Gradient Descent)<a class="headerlink" href="#sgd-stochastic-gradient-descent" title="Permanent link">&para;</a></h3>
<p>Neura takes your feedback <strong>literally and immediately</strong>:</p>
<blockquote>
<p>“Brush #2 was off by 0.1? Got it — let me fix it by exactly that much!”</p>
</blockquote>
<p>Simple and fast
Can be noisy or unstable in tricky paintings</p>
<hr />
<h3 id="adam-adaptive-moment-estimation">Adam (Adaptive Moment Estimation)<a class="headerlink" href="#adam-adaptive-moment-estimation" title="Permanent link">&para;</a></h3>
<p>Neura now keeps a <strong>journal</strong>:</p>
<ul>
<li>Tracks feedback <strong>over time</strong> (momentum)</li>
<li>Adjusts learning speed <strong>per brush</strong></li>
<li>Slows down where things are volatile, speeds up where it’s stable</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>
<p>More stable
Works well on complex or noisy sketches
Great for Neura when she’s dealing with many styles</p>
<hr />
<h2 id="comparison-table">Comparison Table<a class="headerlink" href="#comparison-table" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Concept</th>
<th>SGD</th>
<th>Adam</th>
<th>Neura Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Uses only latest gradient</td>
<td>yes</td>
<td>uses history too</td>
<td>Neura adjusts vs. Neura with memory</td>
</tr>
<tr>
<td>Adapts learning rate</td>
<td>Same for all</td>
<td>Learns per-parameter</td>
<td>Smart pacing for each brush</td>
</tr>
<tr>
<td>Stability</td>
<td>Can overshoot</td>
<td>Very stable</td>
<td>Careful &amp; strategic learning</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="summary-the-feedback-fix-loop">Summary: The Feedback &amp; Fix Loop<a class="headerlink" href="#summary-the-feedback-fix-loop" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Step</th>
<th>Code</th>
<th>Neura Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Compute gradients</td>
<td><code>loss.backward()</code></td>
<td>“How much did each brush cause the mistake?”</td>
</tr>
<tr>
<td>Read the gradients</td>
<td><code>param.grad</code></td>
<td>Feedback note taped to each brush</td>
</tr>
<tr>
<td>Apply corrections</td>
<td><code>optimizer.step()</code></td>
<td>Neura adjusts brush pressure/angle/color</td>
</tr>
<tr>
<td>Clear gradients</td>
<td><code>optimizer.zero_grad()</code></td>
<td>Neura erases old notes before the next painting</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="step-6-training-loop-repetition-makes-perfect">Step 6: Training Loop – Repetition Makes Perfect<a class="headerlink" href="#step-6-training-loop-repetition-makes-perfect" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="analogy-practice-makes-the-painter">Analogy: Practice Makes the Painter<a class="headerlink" href="#analogy-practice-makes-the-painter" title="Permanent link">&para;</a></h2>
<p>At this point, Neura has:</p>
<p>A painting plan (<code>forward()</code>)
A way to assess her results (<code>loss_fn</code>)
A feedback system (<code>loss.backward()</code>)
A strategy to apply changes (<code>optimizer.step()</code>)</p>
<p>But doing this <strong>just once</strong> won’t turn her into an expert.
 She needs to <strong>practice over and over</strong> — painting, reviewing, adjusting.</p>
<p>That’s where the <strong>training loop</strong> comes in.</p>
<hr />
<h2 id="what-happens-in-each-epoch">What Happens in Each Epoch?<a class="headerlink" href="#what-happens-in-each-epoch" title="Permanent link">&para;</a></h2>
<p>Each time Neura goes through the loop (i.e., <strong>an epoch</strong>), she:</p>
<ol>
<li>Receives a batch of sketch inputs</li>
<li>Paints predictions using her current brushes</li>
<li>Compares predictions to the reference paintings</li>
<li>Computes how far off she was (loss)</li>
<li>Traces the mistakes back to specific brushes (gradients)</li>
<li>Updates each brush using the optimizer</li>
<li>Clears feedback for the next round</li>
</ol>
<hr />
<h2 id="code-logging-training-info-in-pandas">Code – Logging Training Info in Pandas<a class="headerlink" href="#code-logging-training-info-in-pandas" title="Permanent link">&para;</a></h2>
<p>We’ll train on <strong>2 sketches</strong> using our existing <code>NeuralPainter</code> model.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Define the model</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NeuralPainter</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># smaller for clarity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Initialize</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NeuralPainter</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>

<span class="c1"># Input sketches (batch of 2) and targets</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">]])</span>

<span class="c1"># Log training info</span>
<span class="n">log</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Training loop</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

    <span class="c1"># Extract data for logging (focusing on first neuron of layer1)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Epoch&#39;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">,</span>
        <span class="s1">&#39;W1[0][0]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;W1[0][1]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;W1[0][2]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;B1[0]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">bias</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Prediction[0]&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Prediction[1]&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Target[0]&#39;</span><span class="p">:</span> <span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Target[1]&#39;</span><span class="p">:</span> <span class="n">targets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Grad_W1[0][0]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="s1">&#39;Grad_B1[0]&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
    <span class="p">})</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="how-to-interpret-the-table">How to Interpret the Table<a class="headerlink" href="#how-to-interpret-the-table" title="Permanent link">&para;</a></h2>
<p>This table is like Neura’s training diary. Each <strong>row = one epoch</strong>.</p>
<p><img alt="Training Loop Table" src="../../images/table_nn_outcomes.png" /></p>
<p>Here’s what the columns mean:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Epoch</code></td>
<td>Iteration count (one painting session)</td>
</tr>
<tr>
<td><code>W1[0][0]</code></td>
<td>Weight from input 0 → neuron 0 in layer 1</td>
</tr>
<tr>
<td><code>W1[0][1]</code>, <code>W1[0][2]</code></td>
<td>Other weights for same neuron</td>
</tr>
<tr>
<td><code>B1[0]</code></td>
<td>Bias for that same neuron</td>
</tr>
<tr>
<td><code>Prediction[0]</code></td>
<td>Neura’s guess for Sketch #1</td>
</tr>
<tr>
<td><code>Target[0]</code></td>
<td>Ground truth for Sketch #1</td>
</tr>
<tr>
<td><code>Loss</code></td>
<td>Average squared error across both samples</td>
</tr>
<tr>
<td><code>Grad_W1[0][0]</code></td>
<td>Gradient for <code>W1[0][0]</code> — how much Neura should adjust it</td>
</tr>
<tr>
<td><code>Grad_B1[0]</code></td>
<td>Bias adjustment signal</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="what-to-look-for">What to Look For:<a class="headerlink" href="#what-to-look-for" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Predictions</strong> should get closer to <strong>targets</strong></li>
<li><strong>Loss</strong> should decrease over time</li>
<li><strong>Weights and bias</strong> will change with each epoch (watch them learn!)</li>
<li><strong>Gradients</strong> should shrink → feedback becomes gentler as Neura improves</li>
</ul>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Step</th>
<th>Action Taken</th>
<th>Neura Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Loop begins</td>
<td>New epoch</td>
<td>Another painting session</td>
</tr>
<tr>
<td><code>model(inputs)</code></td>
<td>Forward pass</td>
<td>Neura paints using current brushes</td>
</tr>
<tr>
<td><code>loss_fn(...)</code></td>
<td>Compute error</td>
<td>You judge the result</td>
</tr>
<tr>
<td><code>loss.backward()</code></td>
<td>Backpropagation</td>
<td>Neura gets specific feedback</td>
</tr>
<tr>
<td><code>optimizer.step()</code></td>
<td>Apply update</td>
<td>Neura tweaks her brush settings</td>
</tr>
<tr>
<td><code>optimizer.zero_grad()</code></td>
<td>Clear old gradients</td>
<td>She starts fresh for the next sketch</td>
</tr>
</tbody>
</table>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../assets/javascripts/extra.js"></script>
      
    
  </body>
</html>